<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.peridot.mapper.MemberMapper">
  
  		<!-- 회원가입 -->
		<insert id="memberJoin" parameterType="memberVO">
	  		 <![CDATA[
					insert into user_ values(seq_user_no.nextval, #{userFirstName}, #{userLastName}, #{userEmail}, #{userPass}, #{userPhone},'n', #{userEmailCheck}, #{userPassCheck},sysdate )
			]]>
			<selectKey resultType="integer" keyProperty="userNo" order="AFTER">
		        SELECT MAX(user_No) FROM user_   
		    </selectKey>
	  	</insert>
	  	
	  	<!-- 아이디 중복검사 -->
	  	<select id="idCheck" resultType="int">
	  		select count(*) from user_ where userEmail = #{userEmail}
	  	</select>
	  	<!-- 로그인 -->
      	<select id="memberLogin" resultType="memberVO" parameterType="memberVO">
      		select userNo as userNo, userFirstName as userFirstName, userLastName as userLastName, userAdmin as userAdmin, userDate as userDate from user_ where userEmail = #{userEmail} and userPass=#{userPass}
      	</select>
      	
      	<!-- 회원정보 수정 -->
	  	<update id="updateMember">
			update user_ set userFirstName=#{userFirstName}, userLastName=#{userLastName}, userEmail=#{userEmail},emailCheck=#{userEmailCheck},userPass=#{userPass}, updatedate = now()
			where userEmail=#{userEmail} and userPass=#{userPass}
		</update>
		
		<!-- 카드추가 -->
		<insert id="cardAdd" parameterType="memberVO">
	  		 <![CDATA[
					insert into user_ values(seq_user_no.nextval, #{userFirstName}, #{userLastName}, #{userEmail}, #{userPass}, #{userPhone},'n', #{userEmailCheck}, #{userPassCheck},sysdate )
			]]>
			<selectKey resultType="integer" keyProperty="userNo" order="AFTER">
		        SELECT MAX(user_No) FROM user_   
		    </selectKey>
	  	</insert>
  </mapper>
  
  